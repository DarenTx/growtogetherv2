<!-- ── Login Page ────────────────────────────────────────────────── -->
<div class="gt-page gt-login-center">
  <div class="gt-card">
    @if (state() === 'sent') {
      <!-- ── Magic link sent ── -->
      <div class="gt-sent-state">
        <div class="gt-sent-icon" aria-hidden="true">✉️</div>
        <h1 class="gt-page-title gt-text-center">Check your messages</h1>
        <p class="gt-page-subtitle gt-text-center">
          We sent a login link to <strong>{{ sentTo() }}</strong
          >. Click it to sign in — it expires in 1 hour.
        </p>
        <div class="gt-btn-row">
          <a role="button" class="gt-link" (click)="tryAgain()">Use a different address</a>
        </div>
      </div>
    } @else {
      <!-- ── Sign-in form ── -->
      <h1 class="gt-page-title">Sign in</h1>
      <p class="gt-page-subtitle">Enter your email to receive a login link.</p>

      <form [formGroup]="form" (ngSubmit)="onSubmit()" class="gt-form">
        <div class="gt-field">
          <label class="gt-label" for="identifier">Email</label>
          <input
            id="identifier"
            type="text"
            formControlName="identifier"
            placeholder="e.g. user@example.com"
            autocomplete="email"
            (blur)="onIdentifierBlur()"
            class="gt-input"
            [attr.aria-invalid]="
              (identifierControl.invalid && identifierControl.touched) || phoneError()
                ? 'true'
                : null
            "
          />

          @if (identifierControl.invalid && identifierControl.touched) {
            <span class="gt-field-error field-error">This field is required.</span>
          }

          @if (phoneError()) {
            <span class="gt-field-error field-error">{{ phoneError() }}</span>
          }

          <p class="gt-help-text">
            • Email: user&#64;example.com<br />
            <!--• USA Phone: (212) 555-1234<br />
            • International: +44 20 7123 4567-->
          </p>
        </div>

        @if (state() === 'error') {
          <div class="gt-banner gt-banner-error" role="alert">{{ errorMessage() }}</div>
        }

        <div class="gt-btn-row">
          <button type="submit" class="gt-btn gt-btn-primary" [disabled]="state() === 'loading'">
            @if (state() === 'loading') {
              Sending…
            } @else {
              Send Login Link
            }
          </button>
        </div>
      </form>
    }
  </div>
</div>
