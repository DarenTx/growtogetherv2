<!-- ── Registration Page ──────────────────────────────────────────── -->
<div class="gt-page">
  <h1 class="gt-page-title">Complete Your Profile</h1>
  <p class="gt-page-subtitle">Fill in the details below to finish setting up your account.</p>

  @if (state() === 'loading') {
    <p class="gt-loading">Loading your profile…</p>
  } @else if (state() === 'error' && !form.dirty) {
    <div role="alert" class="gt-banner gt-banner-error">{{ errorMessage() }}</div>
    <div class="gt-btn-row gt-mt-4">
      <button type="button" class="gt-btn gt-btn-secondary" (click)="ngOnInit()">Try Again</button>
    </div>
  } @else {
    <div class="gt-card">
      <form [formGroup]="form" (ngSubmit)="onSubmit()" class="gt-form">
        <div class="gt-field">
          <label class="gt-label" for="first_name"
            >First Name <span aria-hidden="true">*</span></label
          >
          <input
            id="first_name"
            type="text"
            formControlName="first_name"
            autocomplete="given-name"
            class="gt-input"
          />
          @if (firstNameControl.invalid && firstNameControl.touched) {
            <span class="gt-field-error field-error">First name is required.</span>
          }
        </div>

        <div class="gt-field">
          <label class="gt-label" for="last_name"
            >Last Name <span aria-hidden="true">*</span></label
          >
          <input
            id="last_name"
            type="text"
            formControlName="last_name"
            autocomplete="family-name"
            class="gt-input"
          />
          @if (lastNameControl.invalid && lastNameControl.touched) {
            <span class="gt-field-error field-error">Last name is required.</span>
          }
        </div>

        <div class="gt-field">
          <label class="gt-label" for="email"
            >Email Address <span aria-hidden="true">*</span></label
          >
          <input
            id="email"
            type="email"
            formControlName="email"
            autocomplete="email"
            class="gt-input"
          />
          @if (emailControl.invalid && emailControl.touched) {
            <span class="gt-field-error field-error">A valid email address is required.</span>
          }
        </div>

        <div class="gt-field">
          <label class="gt-label" for="phone">Phone Number <span aria-hidden="true">*</span></label>
          <input
            id="phone"
            type="tel"
            formControlName="phone"
            autocomplete="tel"
            (blur)="onPhoneBlur()"
            class="gt-input"
          />
          @if (phoneError()) {
            <span class="gt-field-error field-error">{{ phoneError() }}</span>
            <span class="gt-field-hint"
              >USA: (212) 555-1234 or 2125551234 | International: +44 20 7123 4567</span
            >
          } @else if (phoneControl.invalid && phoneControl.touched) {
            <span class="gt-field-error field-error">Phone number is required.</span>
          }
        </div>

        <div class="gt-field">
          <label class="gt-label" for="invitation_code"
            >Invitation Code <span aria-hidden="true">*</span></label
          >
          <input
            id="invitation_code"
            type="text"
            formControlName="invitation_code"
            class="gt-input"
          />
          @if (invitationCodeControl.invalid && invitationCodeControl.touched) {
            <span class="gt-field-error field-error">Invitation code is required.</span>
          }
        </div>

        @if (state() === 'error') {
          <div role="alert" class="gt-banner gt-banner-error">{{ errorMessage() }}</div>
        }

        <div class="gt-btn-row">
          <button type="submit" class="gt-btn gt-btn-primary" [disabled]="state() === 'submitting'">
            @if (state() === 'submitting') {
              Saving…
            } @else {
              Complete Registration
            }
          </button>
        </div>
      </form>
    </div>
  }
</div>
